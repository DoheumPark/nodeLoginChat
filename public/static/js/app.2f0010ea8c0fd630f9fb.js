webpackJsonp([1],{0:function(t,o){},MEgr:function(t,o){},NHnr:function(t,o,e){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var s=e("7+uW"),n=e("ppUw"),i=e.n(n),a=e("fpIu"),r=e.n(a);function c(t,o){var e=i.a.get(r.a.cookie.joinChatRoom);if(console.log("cookie - i_chatroom : "+e),null!=e){var s={i_chatroom:e,i_user:o};t.emit("leaveChatRoom",s),i.a.remove(r.a.cookie.joinChatRoom)}}var u={name:"App",data:function(){return{}},mounted:function(){window.onbeforeunload=function(){return"Your work will be lost."}},beforeCreate:function(){if(console.log("this.$store.state.user.i_user : "+this.$store.state.user.i_user),void 0==this.$store.state.user.i_user){var t=i.a.get(r.a.cookie.accessToken);if(console.log("token : "+t),void 0!=t){var o=i.a.get(r.a.cookie.user);if(null==o)return i.a.remove(r.a.cookie.accessToken),void i.a.remove(r.a.cookie.user);this.$axios.defaults.headers.common.Authorization="Bearer "+t,this.$store.commit("setUser",o),this.$socket.emit("login",o)}}},methods:{logout:function(){var t=this,o={i_user:this.$store.state.user.i_user};console.log("i_user : "+o.i_user);var e=this;this.$axios.post("/auth/logout",o).then(function(s){1==s.data&&(c(t.$socket,t.$store.state.user.i_user),e.$socket.emit("logout",o.i_user),i.a.remove(r.a.cookie.accessToken),i.a.remove(r.a.cookie.user),e.$store.commit("setUser",{}),e.$router.push("/login"))})}},computed:{stateUser:function(){return this.$store.state.user}}},m={render:function(){var t=this.$createElement,o=this._self._c||t;return o("div",{attrs:{id:"app"}},[o("nav",[void 0!=this.stateUser.i_user?o("button",{on:{click:this.logout}},[this._v("로그아웃")]):this._e()]),this._v(" "),o("section",[o("router-view")],1)])},staticRenderFns:[]};var h=e("VU/8")(u,m,!1,function(t){e("g9UG"),e("fTOH")},"data-v-af7a9cea",null).exports,l=e("/ocq"),d={name:"UserList",props:{userList:Array}},p={render:function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",t._l(t.userList,function(o){return e("div",{key:o.i_user},[t._v("\n        "+t._s(o.nick_nm)+"\n    ")])}),0)},staticRenderFns:[]},v=e("VU/8")(d,p,!1,null,null,null).exports,_={name:"HomeUserList",components:{UserList:v},props:{userList:Array,showBtnCreateRoom:Boolean},methods:{clkShowCreateRoomWindow:function(){this.$emit("clkShowCreateRoomWindow")}}},f={render:function(){var t=this.$createElement,o=this._self._c||t;return o("div",{attrs:{id:"leftContainer"}},[this.showBtnCreateRoom?o("button",{on:{click:this.clkShowCreateRoomWindow}},[this._v("방 만들기")]):this._e(),this._v(" "),o("user-list",{attrs:{userList:this.userList}})],1)},staticRenderFns:[]},g=e("VU/8")(_,f,!1,null,null,null).exports,k={name:"ChatRoom",data:function(){return{param:{title:"",maxmember:2}}},beforeCreate:function(){},methods:{create:function(){var t=this;""!=this.param.title?this.param.maxmember<2?alert("인원은 최소 2명 이상입니다"):this.$axios.post("/users/regChatRoom",this.param).then(function(o){if(o.data>0){var e={i_chatroom:o.data,title:t.param.title,nick_nm:t.$store.state.user.nick_nm};t.$emit("createChatRoom",e)}else-1==o.data&&(console.log("!!!!"),alert("1111인원은 최소 2명 이상입니다"))}):alert("방 제목을 입력해 주세요")}}},w={render:function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",{attrs:{id:"rightContainer"}},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.param.title,expression:"param.title"}],attrs:{type:"text",placeholder:"방 제목"},domProps:{value:t.param.title},on:{input:function(o){o.target.composing||t.$set(t.param,"title",o.target.value)}}}),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.param.maxmember,expression:"param.maxmember"}],attrs:{type:"number"},domProps:{value:t.param.maxmember},on:{input:function(o){o.target.composing||t.$set(t.param,"maxmember",o.target.value)}}}),t._v(" "),e("button",{on:{click:t.create}},[t._v("방 만들기")])])},staticRenderFns:[]},R=e("VU/8")(k,w,!1,null,null,null).exports,C=e("mvHQ"),L=e.n(C),$={name:"ChatRoom",components:{UserList:v},props:{i_chatroom:Number,chatList:Array},data:function(){return{userList:[]}},beforeMount:function(){i.a.set(r.a.cookie.joinChatRoom,this.i_chatroom),this.getChatRoomUserList()},destroyed:function(){console.log("ChatRoom destroyed!!!!!"),i.a.remove(r.a.cookie.joinChatRoom);var t={i_user:this.$store.state.user.i_user,i_chatroom:this.i_chatroom};this.$socket.emit("leaveChatRoom",t)},sockets:{somebodyJoin:function(t){console.log("somebodyJoin - data : "+L()(t)),this.userList.push(t)},somebodyOut:function(t){console.log("somebodyOut - data : "+L()(t));var o=this.userList.findIndex(function(o){return o.i_user==t.i_user});this.userList.splice(o,1)}},methods:{sendMsg:function(){console.log("sendMsg");var t={i_chatroom:this.i_chatroom,sended_nm:this.$store.state.user.nick_nm,content:this.content};this.$socket.emit("sendMsg",t),this.content=""},leaveChatRoom:function(){this.$emit("leaveChatRoom")},getChatRoomUserList:function(){var t=this;this.$axios.get("/users/getChatRoomUserList",{params:{i_chatroom:t.i_chatroom}}).then(function(o){t.userList=o.data,console.log(t.chatRoomUserList)})}}},b={render:function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",{attrs:{id:"rightContainer"}},[e("div",{attrs:{id:"leftSection"}},[e("div",[e("button",{on:{click:t.leaveChatRoom}},[t._v("방 나가기")])]),t._v(" "),e("div",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],attrs:{type:"text"},domProps:{value:t.content},on:{keydown:function(o){return!o.type.indexOf("key")&&t._k(o.keyCode,"enter",13,o.key,"Enter")?null:t.sendMsg(o)},input:function(o){o.target.composing||(t.content=o.target.value)}}}),t._v(" "),e("button",{on:{click:t.sendMsg}},[t._v("보내기")])]),t._v(" "),t._l(t.chatList,function(o){return e("div",{key:o.i_chat},[t._v("\n       "+t._s(o.sended_nm)+" : "+t._s(o.content)+"\n     ")])})],2),t._v(" "),e("div",{attrs:{id:"rightSection"}},[e("user-list",{attrs:{userList:t.userList}})],1)])},staticRenderFns:[]};var x=e("VU/8")($,b,!1,function(t){e("nDuQ")},"data-v-3896d296",null).exports,y={name:"ChatRoomList",props:{chatRoomList:Array},methods:{clkRoom:function(t){console.log("i_chatroom : "+t);var o={i_chatroom:t,i_user:this.$store.state.user.i_user,nick_nm:this.$store.state.user.nick_nm};this.$emit("joinChatRoom",o)}}},U={render:function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",{attrs:{id:"rightContainer"}},t._l(t.chatRoomList,function(o){return e("div",{key:o.i_chatroom,staticClass:"clickable",on:{click:function(e){return t.clkRoom(o.i_chatroom)}}},[t._v("\n        방이름: "+t._s(o.title)+", 만든사람: "+t._s(o.nick_nm)+"\n    ")])}),0)},staticRenderFns:[]};var j={name:"Home",components:{HomeUserList:g,CreateChatRoom:R,ChatRoom:x,ChatRoomList:e("VU/8")(y,U,!1,function(t){e("MEgr")},"data-v-3ea98da7",null).exports},data:function(){return{i_chatroom:0,user:this.$store.state.user,showWindow:{createChatRoom:!1,chatRoom:!1,chatRoomList:!0},userList:[],chatList:[],chatRoomList:[]}},beforeCreate:function(){c(this.$socket,this.$store.state.user.i_user)},created:function(){var t=this,o=this;this.$axios.get("/users/getLoginUserList").then(function(t){console.log(t.data),o.userList=t.data}),this.$axios.get("/users/getChatRoomList").then(function(o){t.chatRoomList=o.data})},sockets:{somebodyLogin:function(t){console.log("somebodyLogin : "+t.socket_id),console.log("somebodyLogin : "+t.nick_nm);var o=this.userList.findIndex(function(o){return o.i_user==t.i_user});o>=0?this.userList[o].socket_id=t.socket_id:this.userList.push(t)},somebodyLogout:function(t){console.log("somebodyLogout : "+t);var o=this.userList.findIndex(function(o){return o.socket_id==t});o>=0&&this.userList.splice(o,1)},sendMsg:function(t){console.log("method - sendMsg - sended_nm : "+t.sended_nm),this.chatList.push(t)},createChatRoom:function(t){this.chatRoomList.push(t)},destroyChatRoom:function(t){console.log("destroyChatRoom : "+t);var o=this.chatRoomList.findIndex(function(o){return o.i_chatroom==t});o>=0&&this.chatRoomList.splice(o,1)}},methods:{addUser:function(t){console.log("222222"),this.loginUserList[t.socket_id]=t},clkShowCreateRoomWindow:function(){this.procShowWindow("createChatRoom")},createChatRoom:function(t){this.$socket.emit("createChatRoom",t),this.i_chatroom=t.i_chatroom,this.chatList=[],this.procShowWindow("chatRoom")},procShowWindow:function(t){for(var o in this.showWindow)this.showWindow[o]=o==t},joinChatRoom:function(t){var o=this;this.$axios.post("/users/regChatRoomUser",t).then(function(e){1==e.data.state?(console.log("joinChatRoom!!!"),o.$socket.emit("joinChatRoom",t),o.i_chatroom=t.i_chatroom,o.chatList=[],o.procShowWindow("chatRoom")):alert("인원이 꽉 찼습니다")}).catch(function(t){alert("에러 발생"),console.log("joinChatRoom 에러 발생 "+t)})},leaveChatRoom:function(){this.i_chatroom=0,this.chatList=[],this.procShowWindow("chatRoomList")}}},W={render:function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",{attrs:{id:"homeContainer"}},[e("home-user-list",{attrs:{userList:t.userList,showBtnCreateRoom:t.showWindow.chatRoomList},on:{clkShowCreateRoomWindow:t.clkShowCreateRoomWindow}}),t._v(" "),t.showWindow.createChatRoom?e("create-chat-room",{on:{createChatRoom:t.createChatRoom}}):t._e(),t._v(" "),t.showWindow.chatRoom?e("chat-room",{attrs:{i_chatroom:t.i_chatroom,chatList:t.chatList},on:{leaveChatRoom:t.leaveChatRoom}}):t._e(),t._v(" "),t.showWindow.chatRoomList?e("chat-room-list",{attrs:{chatRoomList:t.chatRoomList},on:{joinChatRoom:t.joinChatRoom}}):t._e()],1)},staticRenderFns:[]};var S=e("VU/8")(j,W,!1,function(t){e("OagB")},"data-v-67496958",null).exports,N={name:"Join",data:function(){return{uid:"",upw:"",re_upw:"",nick_nm:""}},methods:{join:function(){console.log("---- start join ----");var t={uid:this.uid,upw:this.upw,nick_nm:this.nick_nm},o=this;this.$axios.post("/auth/join",t).then(function(t){switch(console.log("res.data : "+t.data),t.data){case 0:alert("회원가입에 실패하였습니다.");break;case 1:o.$router.push("/login");break;case 2:alert("아이디에 문제가 발생하였습니다.");break;case 3:alert("비밀번호에 문제가 발생하였습니다.")}}).catch(function(t){console.log("Cannot Join : "+t)})}}},E={render:function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",{staticClass:"hello"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.uid,expression:"uid"}],attrs:{type:"text",placeholder:"아이디"},domProps:{value:t.uid},on:{input:function(o){o.target.composing||(t.uid=o.target.value)}}}),e("br"),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.upw,expression:"upw"}],attrs:{type:"password",placeholder:"비밀번호"},domProps:{value:t.upw},on:{input:function(o){o.target.composing||(t.upw=o.target.value)}}}),e("br"),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.re_upw,expression:"re_upw"}],attrs:{type:"password",placeholder:"확인 비밀번호"},domProps:{value:t.re_upw},on:{input:function(o){o.target.composing||(t.re_upw=o.target.value)}}}),e("br"),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.nick_nm,expression:"nick_nm"}],attrs:{type:"text",placeholder:"닉네임"},domProps:{value:t.nick_nm},on:{input:function(o){o.target.composing||(t.nick_nm=o.target.value)}}}),e("br"),t._v(" "),e("button",{on:{click:t.join}},[t._v("Join")])])},staticRenderFns:[]},M=e("VU/8")(N,E,!1,null,null,null).exports,P=e("pFYg"),T=e.n(P),F={name:"Login",data:function(){return{uid:"",upw:""}},beforeCreate:function(){void 0==this.$store.state.user.i_user||this.$router.push("/home")},methods:{loginSucess:function(t,o){i.a.set(r.a.cookie.user,t),i.a.set(r.a.cookie.accessToken,o),this.$socket.emit("login",t),this.$store.commit("setUser",t),this.$axios.defaults.headers.common.Authorization="Bearer "+o,this.$router.push("/home")},login:function(){console.log("---- start login ----");var t={uid:this.uid,upw:this.upw},o=this;this.$axios.post("/auth/login",t).then(function(t){switch(console.log("res.data.status : "+t.data.status),console.log("typeof : "+T()(t.data.status)),t.data.status){case 1:o.loginSucess(t.data.user,t.data.token);break;case 0:alert("아이디 없음");break;case 2:alert("비번 틀림");break;case 3:alert("다중 로그인 시도 (다른 사람이 사용 중 입니다.)");break;default:alert("에러 발생")}}).catch(function(t){console.log("jjjjjjCannot log in : "+t)})},moveToJoin:function(){this.$router.push("/join")}}},H={render:function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",{staticClass:"hello"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.uid,expression:"uid"}],attrs:{type:"text"},domProps:{value:t.uid},on:{input:function(o){o.target.composing||(t.uid=o.target.value)}}}),e("br"),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.upw,expression:"upw"}],attrs:{type:"password"},domProps:{value:t.upw},on:{input:function(o){o.target.composing||(t.upw=o.target.value)}}}),e("br"),t._v(" "),e("button",{on:{click:t.login}},[t._v("로그인")]),t._v(" "),e("button",{on:{click:t.moveToJoin}},[t._v("회원가입")])])},staticRenderFns:[]},A=e("VU/8")(F,H,!1,null,null,null).exports;s.a.use(l.a);var J=new l.a({routes:[{path:"/login",name:"Login",component:A},{path:"/home",name:"Home",component:S},{path:"/join",name:"Join",component:M},{path:"/chatRoom",name:"ChatRoom",component:x}]}),O=e("mtWM"),V=e.n(O),B=e("NYxO"),I=e("HI0L"),D=e.n(I),Q=e("DmT9"),Y=e.n(Q);s.a.use(B.a),s.a.use(i.a);var z=new B.a.Store({state:{user:{}},mutations:{setUser:function(t,o){t.user=o}},actions:{}});s.a.use(new D.a({debug:!0,connection:Y()("http://192.168.219.102:8899",{transports:["websocket"]}),vuex:{store:z,actionPrefix:"",mutationPrefix:""}})),s.a.prototype.$axios=V.a,s.a.config.productionTip=!1,i.a.config("1h"),new s.a({el:"#app",router:J,components:{App:h},template:"<App/>",store:z})},OagB:function(t,o){},fTOH:function(t,o){},fpIu:function(t,o){t.exports={cookie:{accessToken:"accessToken",user:"user",joinChatRoom:"joinChatRoom"}}},g9UG:function(t,o){},nDuQ:function(t,o){}},["NHnr"]);
//# sourceMappingURL=app.2f0010ea8c0fd630f9fb.js.map